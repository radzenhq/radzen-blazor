@using Radzen
@using Radzen.Blazor.Spreadsheet
<RadzenButton ButtonStyle="ButtonStyle.Base" Click=@OnDeleteColumnClick Icon="delete" ButtonType="ButtonType.Button" Disabled=@IsDisabled />
@code {
#nullable enable

    [Parameter]
    public Sheet? Sheet { get; set; }

    private bool IsDisabled => Sheet == null || Sheet.Selection.Cell == CellRef.Invalid;

    private void OnDeleteColumnClick()
    {
        if (Sheet == null)
        {
            return;
        }
        var range = Sheet.Selection.Range;
        var start = range.Start.Column;
        var end = range.End.Column;
        Sheet.Commands.Execute(new DeleteColumnsCommand(Sheet, start, end));
    }
}


