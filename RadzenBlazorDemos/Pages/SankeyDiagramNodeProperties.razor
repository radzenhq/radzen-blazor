@using Radzen.Blazor
@using System.Collections.Generic

<div class="rz-p-0 rz-p-md-12">
    <RadzenCard Variant="Variant.Outlined" class="rz-mb-12">
        <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Start" Wrap="FlexWrap.Wrap" Gap="1rem">
            <RadzenStack Orientation="Orientation.Vertical" Gap="0.25rem">
                <RadzenLabel Text="Node alignment:" Component="NodeAlignment" />
                <RadzenDropDown @bind-Value="@nodeAlignment" Data="@nodeAlignments" Name="NodeAlignment">
                    <Template Context="alignment">
                        @Enum.GetName(typeof(SankeyAlignment), alignment)
                    </Template>
                </RadzenDropDown>
            </RadzenStack>
            <RadzenStack Orientation="Orientation.Vertical" Gap="0.25rem">
                <RadzenLabel Text="Node width:" Component="NodeWidth" />
                <RadzenNumeric @bind-Value="@nodeWidth" Min="10" Max="50" Name="NodeWidth" />
            </RadzenStack>
            <RadzenStack Orientation="Orientation.Vertical" Gap="0.25rem">
                <RadzenLabel Text="Node padding:" Component="NodePadding" />
                <RadzenNumeric @bind-Value="@nodePadding" Min="2" Max="20" Name="NodePadding" />
            </RadzenStack>
        </RadzenStack>
    </RadzenCard>
    <RadzenSankeyDiagram TItem="FlowData"
                         Data="@flows"
                         SourceProperty="Source"
                         TargetProperty="Target"
                         ValueProperty="Value"
                         SourceLabelProperty="SourceLabel"
                         TargetLabelProperty="TargetLabel"
                         NodeAlignment="@nodeAlignment"
                         NodeWidth="@nodeWidth"
                         NodePadding="@nodePadding">
    </RadzenSankeyDiagram>
</div>

@code {
    public class FlowData
    {
        public string Source { get; set; }
        public string Target { get; set; }
        public double Value { get; set; }
        public string SourceLabel { get; set; }
        public string TargetLabel { get; set; }
    }

    private SankeyAlignment nodeAlignment = SankeyAlignment.Justify;
    private double nodeWidth = 24;
    private double nodePadding = 8;
    private IEnumerable<SankeyAlignment> nodeAlignments = Enum.GetValues(typeof(SankeyAlignment)).Cast<SankeyAlignment>();

    private List<FlowData> flows = new List<FlowData>
    {
        new FlowData { Source = "products", SourceLabel = "Product Sales", Target = "marketing", TargetLabel = "Marketing", Value = 150 },
        new FlowData { Source = "products", SourceLabel = "Product Sales", Target = "engineering", TargetLabel = "Engineering", Value = 280 },
        new FlowData { Source = "products", SourceLabel = "Product Sales", Target = "operations", TargetLabel = "Operations", Value = 70 },
        new FlowData { Source = "services", SourceLabel = "Consulting Services", Target = "marketing", TargetLabel = "Marketing", Value = 100 },
        new FlowData { Source = "services", SourceLabel = "Consulting Services", Target = "engineering", TargetLabel = "Engineering", Value = 160 },
        new FlowData { Source = "licensing", SourceLabel = "Licensing Fees", Target = "engineering", TargetLabel = "Engineering", Value = 80 },
        new FlowData { Source = "licensing", SourceLabel = "Licensing Fees", Target = "operations", TargetLabel = "Operations", Value = 50 },
        new FlowData { Source = "licensing", SourceLabel = "Licensing Fees", Target = "marketing", TargetLabel = "Marketing", Value = 30 },
    };
}
